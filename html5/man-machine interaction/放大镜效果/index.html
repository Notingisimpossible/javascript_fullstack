<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>移动端放大镜效果</title>
		<style type="text/css">
		* {
				margin: 0;
				padding: 0;
				border: none;
			}
			#bgbox{
				width:800px ;
				height: 400px;
				margin: 0;
				padding: 0;
				border:0 ;
			}
			#obj {
				width: 400px;
				height: 255px;
				/*	overflow: scroll;*/
				border: 1px solid #0ff;
				position: relative;
			}
			#obj img {
				width: 400px;
				height: 255px;
				display: block;
			}
			#drag {
				width: 150px;
				height: 150px;
				background: cyan;
				position: absolute;
				left: 0;
				top: 0;
				opacity: 0.4;
				cursor: move;
				display: none;
				border-radius:150px;
			}
			#rightShow {
				margin-left: 20px;
				width: 500px;
				height: 282px;
				border: 1px solid #c0c;
				overflow: hidden;
				display: none;
				position: relative;
			}
			#rightShow img {
				width: 1000px;
				height: 563px;
				position: absolute;
				left: 0;
				top: 0;
			}
	</style>
	</head>
	<body>
		<center>
	<div class="bgbox">
		<li style="list-style: none; padding-left: 40px;color: #00FFFF;font-size: 20px;"><h2>东北虎</h2></li>
		<div id="obj">
			<img src="img/min.jpg" />
			<div id="drag"></div>
		</div>
		<div id="rightShow">
			<img id="rightimg" src="img/max.jpg" />
		</div>
	</div>
	</center>
	</body>
	<script>
		var obj=document.getElementById("obj");
		var drag=document.getElementById("drag");
		var rightshow=document.getElementById("rightShow");
		var rightimg=document.getElementById("rightimg");
		obj.ontouchstart=function(){
			drag.style.display="block";
			rightshow.style.display="block"   
		}
		obj.ontouchmove=function(event){
			var touches = event.touches[0];
			//获得手指移动后drag应该距离obj盒子左、上边有多远
			var lefts = touches.clientX - obj.offsetLeft - (drag.offsetWidth) / 2;
			var tops = touches.clientY - obj.offsetTop - (drag.offsetHeight) / 2;
			//计算向右、向下移动的临界值
			var maxmovex = obj.clientWidth - drag.offsetWidth;
			var maxmovey = obj.clientHeight - drag.offsetHeight;
			//超出临界值即维持在临界值上
			if (lefts > maxmovex) {
				lefts = maxmovex;
			}
			if (tops > maxmovey) {
				tops = maxmovey;
			}
			if (lefts < 0) {
				lefts = 0;
			}
			if (tops < 0) {
				tops = 0;
			}
			//手指移动后对drag盒子定位
			drag.style.left = lefts + "px";
			drag.style.top = tops + "px";
			//对放大图进行等比反向移动
			var percentageX = lefts/(obj.offsetWidth-drag.offsetWidth);
			var percentageY = tops/(obj.offsetHeight-drag.offsetHeight);
			rightshow.scrollLeft = (rightimg.offsetWidth-rightshow.offsetWidth) * percentageX;
			rightshow.scrollTop = (rightimg.offsetHeight-rightshow.offsetHeight) * percentageY;
		}
		obj.ontouchend=function(){
			drag.style.display = "none";
			rightShow.style.display = "none";
		}
	</script>
</html>
